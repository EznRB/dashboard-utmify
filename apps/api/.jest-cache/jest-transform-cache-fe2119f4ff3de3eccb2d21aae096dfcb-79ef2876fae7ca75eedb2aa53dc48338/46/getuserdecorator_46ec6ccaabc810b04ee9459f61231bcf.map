{"version":3,"names":["cov_2kbb79g31","actualCoverage","createParamDecorator","ForbiddenException","GetUser","s","data","ctx","f","request","switchToHttp","getRequest","user","b","Error","tenant","organizationId","id","GetUserId","GetUserOrganizationId"],"sources":["C:\\Users\\Enzo Marcelo\\Desktop\\Projetos Empresa\\Saas Utmify\\utmify-clone\\apps\\api\\src\\decorators\\get-user.decorator.ts"],"sourcesContent":["import { createParamDecorator, ExecutionContext, ForbiddenException } from '@nestjs/common';\n\nexport interface AuthUser {\n  id: string;\n  email: string;\n  organizationId: string;\n  role: string;\n  firstName?: string;\n  lastName?: string;\n}\n\nexport const GetUser = createParamDecorator(\n  (data: unknown, ctx: ExecutionContext): AuthUser => {\n    const request = ctx.switchToHttp().getRequest();\n    \n    if (!request.user) {\n      throw new Error('User information not found in request. Make sure authentication is properly configured.');\n    }\n    \n    // Validar acesso cross-tenant\n    if (request.tenant && request.user.organizationId !== request.tenant.id) {\n      throw new ForbiddenException('Acesso negado: usuário não pertence a esta organização.');\n    }\n    \n    return request.user;\n  },\n);\n\n/**\n * Decorator para obter apenas o ID do usuário\n */\nexport const GetUserId = createParamDecorator(\n  (data: unknown, ctx: ExecutionContext): string => {\n    const request = ctx.switchToHttp().getRequest();\n    \n    if (!request.user?.id) {\n      throw new Error('User ID not found in request.');\n    }\n    \n    return request.user.id;\n  },\n);\n\n/**\n * Decorator para obter o ID da organização do usuário\n */\nexport const GetUserOrganizationId = createParamDecorator(\n  (data: unknown, ctx: ExecutionContext): string => {\n    const request = ctx.switchToHttp().getRequest();\n    \n    if (!request.user?.organizationId) {\n      throw new Error('User organization ID not found in request.');\n    }\n    \n    return request.user.organizationId;\n  },\n);"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA+BO;IAAAA,aAAA,YAAAA,CAAA;MAAA,OAAAC,cAAA;IAAA;EAAA;EAAA,OAAAA,cAAA;AAAA;AAAAD,aAAA;AA/BP,SAASE,oBAAoB,EAAoBC,kBAAkB,QAAQ,gBAAgB;AAW3F,OAAO,MAAMC,OAAO;AAAA;AAAA,CAAAJ,aAAA,GAAAK,CAAA,OAAGH,oBAAoB,CACzC,CAACI,IAAa,EAAEC,GAAqB,KAAc;EAAA;EAAAP,aAAA,GAAAQ,CAAA;EACjD,MAAMC,OAAO;EAAA;EAAA,CAAAT,aAAA,GAAAK,CAAA,OAAGE,GAAG,CAACG,YAAY,EAAE,CAACC,UAAU,EAAE;EAAC;EAAAX,aAAA,GAAAK,CAAA;EAEhD,IAAI,CAACI,OAAO,CAACG,IAAI,EAAE;IAAA;IAAAZ,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAK,CAAA;IACjB,MAAM,IAAIS,KAAK,CAAC,yFAAyF,CAAC;EAC5G,CAAC;EAAA;EAAA;IAAAd,aAAA,GAAAa,CAAA;EAAA;EAED;EAAAb,aAAA,GAAAK,CAAA;EACA;EAAI;EAAA,CAAAL,aAAA,GAAAa,CAAA,UAAAJ,OAAO,CAACM,MAAM;EAAA;EAAA,CAAAf,aAAA,GAAAa,CAAA,UAAIJ,OAAO,CAACG,IAAI,CAACI,cAAc,KAAKP,OAAO,CAACM,MAAM,CAACE,EAAE,GAAE;IAAA;IAAAjB,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAK,CAAA;IACvE,MAAM,IAAIF,kBAAkB,CAAC,yDAAyD,CAAC;EACzF,CAAC;EAAA;EAAA;IAAAH,aAAA,GAAAa,CAAA;EAAA;EAAAb,aAAA,GAAAK,CAAA;EAED,OAAOI,OAAO,CAACG,IAAI;AACrB,CAAC,CACF;AAED;;;AAGA,OAAO,MAAMM,SAAS;AAAA;AAAA,CAAAlB,aAAA,GAAAK,CAAA,OAAGH,oBAAoB,CAC3C,CAACI,IAAa,EAAEC,GAAqB,KAAY;EAAA;EAAAP,aAAA,GAAAQ,CAAA;EAC/C,MAAMC,OAAO;EAAA;EAAA,CAAAT,aAAA,GAAAK,CAAA,OAAGE,GAAG,CAACG,YAAY,EAAE,CAACC,UAAU,EAAE;EAAC;EAAAX,aAAA,GAAAK,CAAA;EAEhD,IAAI,CAACI,OAAO,CAACG,IAAI,EAAEK,EAAE,EAAE;IAAA;IAAAjB,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAK,CAAA;IACrB,MAAM,IAAIS,KAAK,CAAC,+BAA+B,CAAC;EAClD,CAAC;EAAA;EAAA;IAAAd,aAAA,GAAAa,CAAA;EAAA;EAAAb,aAAA,GAAAK,CAAA;EAED,OAAOI,OAAO,CAACG,IAAI,CAACK,EAAE;AACxB,CAAC,CACF;AAED;;;AAGA,OAAO,MAAME,qBAAqB;AAAA;AAAA,CAAAnB,aAAA,GAAAK,CAAA,QAAGH,oBAAoB,CACvD,CAACI,IAAa,EAAEC,GAAqB,KAAY;EAAA;EAAAP,aAAA,GAAAQ,CAAA;EAC/C,MAAMC,OAAO;EAAA;EAAA,CAAAT,aAAA,GAAAK,CAAA,QAAGE,GAAG,CAACG,YAAY,EAAE,CAACC,UAAU,EAAE;EAAC;EAAAX,aAAA,GAAAK,CAAA;EAEhD,IAAI,CAACI,OAAO,CAACG,IAAI,EAAEI,cAAc,EAAE;IAAA;IAAAhB,aAAA,GAAAa,CAAA;IAAAb,aAAA,GAAAK,CAAA;IACjC,MAAM,IAAIS,KAAK,CAAC,4CAA4C,CAAC;EAC/D,CAAC;EAAA;EAAA;IAAAd,aAAA,GAAAa,CAAA;EAAA;EAAAb,aAAA,GAAAK,CAAA;EAED,OAAOI,OAAO,CAACG,IAAI,CAACI,cAAc;AACpC,CAAC,CACF","ignoreList":[]}