{"version":3,"names":["cov_es7as08ko","actualCoverage","asyncHandler","s","requireAuth","request","reply","f","generateMockMetrics","faturamentoLiquido","value","Math","random","variation","period","gastosAnuncios","roas","lucro","roi","margemLucro","conversoes","floor","ticketMedio","dashboardRoutes","app","get","preHandler","schema","tags","summary","description","metrics","status","send","success","data","totalCampaigns","activeCampaigns","totalSpent","totalRevenue","averageRoas"],"sources":["C:\\Users\\Enzo Marcelo\\Desktop\\Projetos Empresa\\Saas Utmify\\utmify-clone\\apps\\api\\src\\routes\\dashboard.routes.ts"],"sourcesContent":["import { FastifyInstance } from 'fastify';\nimport { authMiddleware } from '../middleware/auth.middleware';\nimport { asyncHandler } from '../utils/errors';\n\n// Tipos para as métricas do dashboard\ninterface DashboardMetrics {\n  faturamentoLiquido: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  gastosAnuncios: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  roas: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  lucro: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  roi: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  margemLucro: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  conversoes: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n  ticketMedio: {\n    value: number;\n    variation: number;\n    period: string;\n  };\n}\n\n// Middleware de autenticação - TEMPORARILY DISABLED FOR DEVELOPMENT\nconst requireAuth = async (request: any, reply: any) => {\n  // DEVELOPMENT: Skip auth for testing\n  // await authMiddleware(request, reply, {\n  //   required: true,\n  //   organizationRequired: false\n  // });\n  return; // Skip auth for now\n};\n\n// Função para gerar dados mockados das métricas\nfunction generateMockMetrics(): DashboardMetrics {\n  return {\n    faturamentoLiquido: {\n      value: 635789.23 + (Math.random() - 0.5) * 50000,\n      variation: 12.5 + (Math.random() - 0.5) * 10,\n      period: 'vs mês anterior'\n    },\n    gastosAnuncios: {\n      value: 456827.90 + (Math.random() - 0.5) * 30000,\n      variation: -8.2 + (Math.random() - 0.5) * 8,\n      period: 'vs mês anterior'\n    },\n    roas: {\n      value: 1.39 + (Math.random() - 0.5) * 0.5,\n      variation: 15.3 + (Math.random() - 0.5) * 12,\n      period: 'vs mês anterior'\n    },\n    lucro: {\n      value: 159887.65 + (Math.random() - 0.5) * 20000,\n      variation: 22.1 + (Math.random() - 0.5) * 15,\n      period: 'vs mês anterior'\n    },\n    roi: {\n      value: 35.0 + (Math.random() - 0.5) * 10,\n      variation: 18.7 + (Math.random() - 0.5) * 12,\n      period: 'vs mês anterior'\n    },\n    margemLucro: {\n      value: 25.1 + (Math.random() - 0.5) * 8,\n      variation: 5.4 + (Math.random() - 0.5) * 6,\n      period: 'vs mês anterior'\n    },\n    conversoes: {\n      value: Math.floor(1247 + (Math.random() - 0.5) * 300),\n      variation: 28.9 + (Math.random() - 0.5) * 20,\n      period: 'vs mês anterior'\n    },\n    ticketMedio: {\n      value: 510.23 + (Math.random() - 0.5) * 100,\n      variation: -3.1 + (Math.random() - 0.5) * 8,\n      period: 'vs mês anterior'\n    }\n  };\n}\n\nexport async function dashboardRoutes(app: FastifyInstance) {\n  // GET /dashboard/metrics - Obter métricas do dashboard\n  app.get(\n    '/metrics',\n    {\n      preHandler: requireAuth,\n      schema: {\n        tags: ['Dashboard'],\n        summary: 'Get dashboard metrics',\n        description: 'Retrieve main dashboard metrics with variations'\n      }\n    },\n    asyncHandler(async (request: any, reply) => {\n      const metrics = generateMockMetrics();\n      \n      return reply.status(200).send({\n        success: true,\n        data: metrics\n      });\n    })\n  );\n\n  // GET /dashboard/overview - Obter visão geral do dashboard\n  app.get(\n    '/overview',\n    {\n      preHandler: requireAuth,\n      schema: {\n        tags: ['Dashboard'],\n        summary: 'Get dashboard overview',\n        description: 'Retrieve complete dashboard overview data'\n      }\n    },\n    asyncHandler(async (request: any, reply) => {\n      const metrics = generateMockMetrics();\n      \n      return reply.status(200).send({\n        success: true,\n        data: {\n          metrics,\n          summary: {\n            totalCampaigns: 5,\n            activeCampaigns: 3,\n            totalSpent: 32378,\n            totalRevenue: 89456,\n            averageRoas: 2.76\n          }\n        }\n      });\n    })\n  );\n}"],"mappings":"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","ignoreList":[]}