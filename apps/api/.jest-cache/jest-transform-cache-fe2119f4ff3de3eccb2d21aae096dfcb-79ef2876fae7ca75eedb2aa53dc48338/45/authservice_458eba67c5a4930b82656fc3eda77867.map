{"version":3,"names":["cov_r9zfrkqas","actualCoverage","nanoid","bcrypt","db","jwtConfig","logger","logAuth","ApiError","AuthService","app","constructor","f","s","generateTokens","user","sessionId","payload","userId","id","organizationId","role","email","refreshTokenId","refreshPayload","tokenId","accessToken","jwt","sign","expiresIn","accessExpiresIn","refreshToken","secret","refreshSecret","refreshExpiresIn","refreshTokenKey","refreshTokenData","createdAt","Date","toISOString","redis","setex","JSON","stringify","verify","tokenData","get","b","parsedTokenData","parse","findUnique","where","include","organization","isActive","session","userSession","expiresAt","newTokens","del","error","login","password","ip","userAgent","toLowerCase","undefined","isValidPassword","compare","setDate","getDate","create","data","ipAddress","update","lastLoginAt","tokens","_","safeUser","register","name","organizationName","existingUser","baseSlug","replace","substring","slug","counter","hashedPassword","hash","result","$transaction","tx","planType","settings","timezone","currency","dateFormat","allowPublicDashboard","requireTwoFactor","maxUsers","customBranding","logout","verifyToken","token","getUserSessions","findMany","gt","orderBy","select","revokeSession","updateMany","revokeAllSessions"],"sources":["C:\\Users\\Enzo Marcelo\\Desktop\\Projetos Empresa\\Saas Utmify\\utmify-clone\\apps\\api\\src\\services\\auth.service.ts"],"sourcesContent":["import { nanoid } from 'nanoid'\nimport bcrypt from 'bcryptjs'\nimport type { FastifyInstance } from 'fastify'\nimport { db } from '@utmify/database'\nimport type { User, Organization, UserRole } from '@utmify/shared'\nimport { jwtConfig } from '@/config/env'\nimport { logger, logAuth } from '@/utils/logger'\nimport { ApiError } from '@/utils/errors'\n\nexport interface AuthTokens {\n  accessToken: string\n  refreshToken: string\n  expiresIn: number\n}\n\nexport interface JWTPayload {\n  userId: string\n  organizationId: string\n  role: UserRole\n  email: string\n  sessionId: string\n}\n\nexport interface RefreshTokenPayload {\n  userId: string\n  sessionId: string\n  tokenId: string\n}\n\nexport class AuthService {\n  constructor(private app: FastifyInstance) {}\n\n  // Generate JWT tokens\n  async generateTokens(user: User, sessionId: string): Promise<AuthTokens> {\n    const payload: JWTPayload = {\n      userId: user.id,\n      organizationId: user.organizationId,\n      role: user.role,\n      email: user.email,\n      sessionId,\n    }\n\n    const refreshTokenId = nanoid()\n    const refreshPayload: RefreshTokenPayload = {\n      userId: user.id,\n      sessionId,\n      tokenId: refreshTokenId,\n    }\n\n    // Generate access token\n    const accessToken = this.app.jwt.sign(payload, {\n      expiresIn: jwtConfig.accessExpiresIn,\n    })\n\n    // Generate refresh token with different secret\n    const refreshToken = this.app.jwt.sign(refreshPayload, {\n      secret: jwtConfig.refreshSecret,\n      expiresIn: jwtConfig.refreshExpiresIn,\n    })\n\n    // Store refresh token in Redis\n    const refreshTokenKey = `refresh_token:${refreshTokenId}`\n    const refreshTokenData = {\n      userId: user.id,\n      sessionId,\n      createdAt: new Date().toISOString(),\n    }\n\n    await this.app.redis.setex(\n      refreshTokenKey,\n      7 * 24 * 60 * 60, // 7 days in seconds\n      JSON.stringify(refreshTokenData)\n    )\n\n    // Calculate expiration time\n    const expiresIn = 15 * 60 // 15 minutes in seconds\n\n    return {\n      accessToken,\n      refreshToken,\n      expiresIn,\n    }\n  }\n\n  // Verify and refresh access token\n  async refreshToken(refreshToken: string): Promise<AuthTokens> {\n    try {\n      // Verify refresh token\n      const payload = this.app.jwt.verify(refreshToken, {\n        secret: jwtConfig.refreshSecret,\n      }) as RefreshTokenPayload\n\n      // Check if refresh token exists in Redis\n      const refreshTokenKey = `refresh_token:${payload.tokenId}`\n      const tokenData = await this.app.redis.get(refreshTokenKey)\n\n      if (!tokenData) {\n        throw new ApiError('Invalid refresh token', 'INVALID_REFRESH_TOKEN', 401)\n      }\n\n      const parsedTokenData = JSON.parse(tokenData)\n      if (parsedTokenData.userId !== payload.userId || parsedTokenData.sessionId !== payload.sessionId) {\n        throw new ApiError('Invalid refresh token', 'INVALID_REFRESH_TOKEN', 401)\n      }\n\n      // Get user from database\n      const user = await db.user.findUnique({\n        where: { id: payload.userId },\n        include: { organization: true },\n      })\n\n      if (!user || !user.isActive) {\n        throw new ApiError('User not found or inactive', 'USER_NOT_FOUND', 401)\n      }\n\n      // Check if session is still valid\n      const session = await db.userSession.findUnique({\n        where: { id: payload.sessionId },\n      })\n\n      if (!session || session.expiresAt < new Date()) {\n        throw new ApiError('Session expired', 'SESSION_EXPIRED', 401)\n      }\n\n      // Generate new tokens\n      const newTokens = await this.generateTokens(user, payload.sessionId)\n\n      // Remove old refresh token\n      await this.app.redis.del(refreshTokenKey)\n\n      logAuth('token_refreshed', user.id, user.email)\n\n      return newTokens\n    } catch (error) {\n      if (error instanceof ApiError) {\n        throw error\n      }\n      throw new ApiError('Invalid refresh token', 'INVALID_REFRESH_TOKEN', 401)\n    }\n  }\n\n  // Login user\n  async login(email: string, password: string, ip?: string, userAgent?: string): Promise<{\n    user: Omit<User, 'password'>\n    organization: Organization\n    tokens: AuthTokens\n  }> {\n    // Find user with organization\n    const user = await db.user.findUnique({\n      where: { email: email.toLowerCase() },\n      include: { organization: true },\n    })\n\n    if (!user) {\n      logAuth('login_failed', undefined, email, ip, false)\n      throw new ApiError('Invalid credentials', 'INVALID_CREDENTIALS', 401)\n    }\n\n    // Check if user is active\n    if (!user.isActive) {\n      logAuth('login_failed_inactive', user.id, email, ip, false)\n      throw new ApiError('Account is disabled', 'ACCOUNT_DISABLED', 401)\n    }\n\n    // Verify password\n    const isValidPassword = await bcrypt.compare(password, user.password)\n    if (!isValidPassword) {\n      logAuth('login_failed', user.id, email, ip, false)\n      throw new ApiError('Invalid credentials', 'INVALID_CREDENTIALS', 401)\n    }\n\n    // Check if organization is active\n    if (!user.organization.isActive) {\n      logAuth('login_failed_org_inactive', user.id, email, ip, false)\n      throw new ApiError('Organization is disabled', 'ORGANIZATION_DISABLED', 401)\n    }\n\n    // Create user session\n    const sessionId = nanoid()\n    const expiresAt = new Date()\n    expiresAt.setDate(expiresAt.getDate() + 7) // 7 days\n\n    await db.userSession.create({\n      data: {\n        id: sessionId,\n        userId: user.id,\n        ipAddress: ip,\n        userAgent,\n        expiresAt,\n      },\n    })\n\n    // Update last login\n    await db.user.update({\n      where: { id: user.id },\n      data: { lastLoginAt: new Date() },\n    })\n\n    // Generate tokens\n    const tokens = await this.generateTokens(user, sessionId)\n\n    logAuth('login_success', user.id, email, ip)\n\n    // Remove password from response\n    const { password: _, ...safeUser } = user\n\n    return {\n      user: safeUser,\n      organization: user.organization,\n      tokens,\n    }\n  }\n\n  // Register new user and organization\n  async register(data: {\n    name: string\n    email: string\n    password: string\n    organizationName: string\n  }, ip?: string): Promise<{\n    user: Omit<User, 'password'>\n    organization: Organization\n    tokens: AuthTokens\n  }> {\n    const { name, email, password, organizationName } = data\n\n    // Check if user already exists\n    const existingUser = await db.user.findUnique({\n      where: { email: email.toLowerCase() },\n    })\n\n    if (existingUser) {\n      throw new ApiError('Email already exists', 'EMAIL_ALREADY_EXISTS', 409)\n    }\n\n    // Generate organization slug\n    const baseSlug = organizationName\n      .toLowerCase()\n      .replace(/[^a-z0-9]+/g, '-')\n      .replace(/(^-|-$)/g, '')\n      .substring(0, 50)\n\n    let slug = baseSlug\n    let counter = 1\n\n    // Ensure unique slug\n    while (await db.organization.findUnique({ where: { slug } })) {\n      slug = `${baseSlug}-${counter}`\n      counter++\n    }\n\n    // Hash password\n    const hashedPassword = await bcrypt.hash(password, 12)\n\n    // Create organization and user in transaction\n    const result = await db.$transaction(async (tx) => {\n      // Create organization\n      const organization = await tx.organization.create({\n        data: {\n          name: organizationName,\n          slug,\n          planType: 'STARTER',\n          isActive: true,\n          settings: {\n            timezone: 'UTC',\n            currency: 'USD',\n            dateFormat: 'MM/DD/YYYY',\n            allowPublicDashboard: false,\n            requireTwoFactor: false,\n            maxUsers: 2,\n            customBranding: false,\n          },\n        },\n      })\n\n      // Create user as organization owner\n      const user = await tx.user.create({\n        data: {\n          name,\n          email: email.toLowerCase(),\n          password: hashedPassword,\n          role: 'OWNER',\n          isActive: true,\n          organizationId: organization.id,\n        },\n      })\n\n      return { user, organization }\n    })\n\n    // Create user session\n    const sessionId = nanoid()\n    const expiresAt = new Date()\n    expiresAt.setDate(expiresAt.getDate() + 7) // 7 days\n\n    await db.userSession.create({\n      data: {\n        id: sessionId,\n        userId: result.user.id,\n        ipAddress: ip,\n        expiresAt,\n      },\n    })\n\n    // Generate tokens\n    const tokens = await this.generateTokens(result.user, sessionId)\n\n    logAuth('register_success', result.user.id, email, ip)\n\n    // Remove password from response\n    const { password: _, ...safeUser } = result.user\n\n    return {\n      user: safeUser,\n      organization: result.organization,\n      tokens,\n    }\n  }\n\n  // Logout user\n  async logout(sessionId: string, refreshToken?: string): Promise<void> {\n    try {\n      // Invalidate session\n      await db.userSession.update({\n        where: { id: sessionId },\n        data: { expiresAt: new Date() },\n      })\n\n      // Remove refresh token from Redis if provided\n      if (refreshToken) {\n        try {\n          const payload = this.app.jwt.verify(refreshToken, {\n            secret: jwtConfig.refreshSecret,\n          }) as RefreshTokenPayload\n\n          const refreshTokenKey = `refresh_token:${payload.tokenId}`\n          await this.app.redis.del(refreshTokenKey)\n        } catch {\n          // Ignore errors when removing refresh token\n        }\n      }\n\n      logAuth('logout_success')\n    } catch (error) {\n      logger.error(error, 'Error during logout')\n      throw new ApiError('Logout failed', 'LOGOUT_FAILED', 500)\n    }\n  }\n\n  // Verify JWT token and get user\n  async verifyToken(token: string): Promise<{\n    user: Omit<User, 'password'>\n    organization: Organization\n    sessionId: string\n  }> {\n    try {\n      // Verify token\n      const payload = this.app.jwt.verify(token) as JWTPayload\n\n      // Check if session is still valid\n      const session = await db.userSession.findUnique({\n        where: { id: payload.sessionId },\n      })\n\n      if (!session || session.expiresAt < new Date()) {\n        throw new ApiError('Session expired', 'SESSION_EXPIRED', 401)\n      }\n\n      // Get user with organization\n      const user = await db.user.findUnique({\n        where: { id: payload.userId },\n        include: { organization: true },\n      })\n\n      if (!user || !user.isActive) {\n        throw new ApiError('User not found or inactive', 'USER_NOT_FOUND', 401)\n      }\n\n      if (!user.organization.isActive) {\n        throw new ApiError('Organization is disabled', 'ORGANIZATION_DISABLED', 401)\n      }\n\n      // Remove password from response\n      const { password: _, ...safeUser } = user\n\n      return {\n        user: safeUser,\n        organization: user.organization,\n        sessionId: payload.sessionId,\n      }\n    } catch (error) {\n      if (error instanceof ApiError) {\n        throw error\n      }\n      throw new ApiError('Invalid token', 'INVALID_TOKEN', 401)\n    }\n  }\n\n  // Get all active sessions for a user\n  async getUserSessions(userId: string): Promise<any[]> {\n    return db.userSession.findMany({\n      where: {\n        userId,\n        expiresAt: { gt: new Date() },\n      },\n      orderBy: { createdAt: 'desc' },\n      select: {\n        id: true,\n        ipAddress: true,\n        userAgent: true,\n        createdAt: true,\n        expiresAt: true,\n      },\n    })\n  }\n\n  // Revoke a specific session\n  async revokeSession(sessionId: string, userId: string): Promise<void> {\n    await db.userSession.updateMany({\n      where: {\n        id: sessionId,\n        userId,\n      },\n      data: {\n        expiresAt: new Date(),\n      },\n    })\n\n    logAuth('session_revoked', userId)\n  }\n\n  // Revoke all sessions for a user\n  async revokeAllSessions(userId: string): Promise<void> {\n    await db.userSession.updateMany({\n      where: { userId },\n      data: { expiresAt: new Date() },\n    })\n\n    logAuth('all_sessions_revoked', userId)\n  }\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}