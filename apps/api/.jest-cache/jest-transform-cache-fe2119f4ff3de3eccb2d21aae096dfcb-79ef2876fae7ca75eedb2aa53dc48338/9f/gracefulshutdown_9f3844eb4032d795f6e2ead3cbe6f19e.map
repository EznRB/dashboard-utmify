{"version":3,"names":["logger","cov_1l5qv4lahb","s","gracefulShutdown","app","f","signals","forEach","signal","process","on","info","close","exit","error","code","fatal","reason","promise"],"sources":["C:\\Users\\Enzo Marcelo\\Desktop\\Projetos Empresa\\Saas Utmify\\utmify-clone\\apps\\api\\src\\utils\\graceful-shutdown.ts"],"sourcesContent":["import type { FastifyInstance } from 'fastify'\nimport { logger } from './logger'\n\n// Graceful shutdown handler\nexport const gracefulShutdown = (app: FastifyInstance) => {\n  const signals = ['SIGTERM', 'SIGINT', 'SIGUSR2'] as const\n  \n  signals.forEach((signal) => {\n    process.on(signal, async () => {\n      logger.info(`Received ${signal}, starting graceful shutdown...`)\n      \n      try {\n        // Close Fastify server\n        await app.close()\n        logger.info('✅ Server closed successfully')\n        \n        // Exit process\n        process.exit(0)\n      } catch (error) {\n        logger.error(error, '❌ Error during graceful shutdown')\n        process.exit(1)\n      }\n    })\n  })\n  \n  // Handle process termination\n  process.on('exit', (code) => {\n    logger.info(`Process exiting with code: ${code}`)\n  })\n  \n  // Handle uncaught exceptions\n  process.on('uncaughtException', (error) => {\n    logger.fatal(error, 'Uncaught Exception - shutting down')\n    process.exit(1)\n  })\n  \n  // Handle unhandled promise rejections\n  process.on('unhandledRejection', (reason, promise) => {\n    logger.fatal({\n      reason,\n      promise,\n    }, 'Unhandled Rejection - shutting down')\n    process.exit(1)\n  })\n  \n  logger.info('✅ Graceful shutdown handlers registered')\n}"],"mappings":"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","ignoreList":[]}